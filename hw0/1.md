```mermaid
flowchart TD
    A[Start: Load Metadata and Tag Count] --> B[Explode Tags in Metadata]
    B --> C[Calculate Tag and Type Totals]
    C --> D[Process User Interaction Log]
    D --> E[Calculate Tag Click Rates]
    D --> F[Calculate Type Click Rates]
    E --> G[Sort Tags by Click Rate and Timestamp]
    F --> H[Sort Types by Click Rate and Timestamp]
    G --> I[Create Candidates for Artworks by Tag and Type]
    H --> I
    I --> J[Filter Interacted and Recommended Artworks]
    J --> K[Determine Remaining Artworks Count]
    K --> L[Allocate Artworks Proportionally by Type]
    L --> M[Adjust Total Artworks Based on Remaining Capacity]
    M --> N[Select Final Artworks for Each Type]
    N --> O[Return Selected Artworks and Corresponding Tags]
    style A fill:#f9f,stroke:#333,stroke-width:2px;
    style O fill:#0f9,stroke:#333,stroke-width:2px;
    style N fill:#f96,stroke:#333,stroke-width:2px;
